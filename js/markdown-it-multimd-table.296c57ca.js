function b(){this.__highest_alphabet__=0,this.__match_alphabets__={},this.__initial_state__=0,this.__accept_states__={},this.__transitions__={},this.__actions__={}}b.prototype.set_highest_alphabet=function(u){this.__highest_alphabet__=u};b.prototype.set_match_alphabets=function(u){this.__match_alphabets__=u};b.prototype.set_initial_state=function(u){this.__initial_state__=u};b.prototype.set_accept_states=function(u){for(var x=0;x<u.length;x++)this.__accept_states__[u[x]]=!0};b.prototype.set_transitions=function(u){this.__transitions__=u};b.prototype.set_actions=function(u){this.__actions__=u};b.prototype.update_transition=function(u,x){this.__transitions__[u]=Object.assign(this.__transitions__[u]||Object(),x)};b.prototype.execute=function(u,x){var o,k,m;for(o=this.__initial_state__,k=u;o&&k<x;k++){for(m=this.__highest_alphabet__;m>0&&!(o&m&&this.__match_alphabets__[m].call(this,k,o,m));m>>=4);if(this.__actions__(k,o,m),m===0)break;o=this.__transitions__[o][m]||0}return!!this.__accept_states__[o]};var G=b,z=G,q=function(x,o){var k={multiline:!1,rowspan:!1,headerless:!1,multibody:!0,autolabel:!0};o=x.utils.assign({},k,o||{});function m(e,c){var i=e.bMarks[c]+e.sCount[c],s=e.bMarks[c]+e.blkIndent,l=e.skipSpacesBack(e.eMarks[c],s),p=[],n,t,a=!1,r=!1;for(n=i;n<l;n++)switch(e.src.charCodeAt(n)){case 92:a=!0;break;case 96:t=e.skipChars(n,96)-1,t>n?n=t:(r||!a)&&(r=!r),a=!1;break;case 124:!r&&!a&&p.push(n),a=!1;break;default:a=!1;break}return p.length===0||(p[0]>s&&p.unshift(s-1),p[p.length-1]<l-1&&p.push(l)),p}function D(e,c,i){var s={text:null,label:null},l=e.bMarks[i]+e.sCount[i],p=e.eMarks[i],n=/^\[(.+?)\](\[([^\[\]]+)\])?\s*$/,t=e.src.slice(l,p).match(n);return t?c?!0:(s.text=t[1],!o.autolabel&&!t[2]||(s.label=t[2]||t[1],s.label=s.label.toLowerCase().replace(/\W+/g,"")),s):!1}function T(e,c,i){var s={bounds:null,multiline:null},l=m(e,i),p,n,t;return l.length<2?!1:c?!0:(s.bounds=l,o.multiline&&(p=e.bMarks[i]+e.sCount[i],n=e.eMarks[i]-1,s.multiline=e.src.charCodeAt(n)===92,s.multiline&&(t=e.eMarks[i],e.eMarks[i]=e.skipSpacesBack(n,p),s.bounds=m(e,i),e.eMarks[i]=t)),s)}function E(e,c,i){var s={aligns:[],wraps:[]},l=m(e,i),p=/^:?(-+|=+):?\+?$/,n,t,a;if(e.sCount[i]-e.blkIndent>=4||l.length===0)return!1;for(n=0;n<l.length-1;n++){if(t=e.src.slice(l[n]+1,l[n+1]).trim(),!p.test(t))return!1;switch(s.wraps.push(t.charCodeAt(t.length-1)===43),a=(t.charCodeAt(0)===58)<<4|t.charCodeAt(t.length-1-s.wraps[n])===58,a){case 0:s.aligns.push("");break;case 1:s.aligns.push("right");break;case 16:s.aligns.push("left");break;case 17:s.aligns.push("center");break}}return c?!0:s}function I(e,c,i){return e.isEmpty(i)}function O(e,c,i,s){var l=new z,p=16,n=-1,t,a,r,S,y,j,v=[],R,B,h,d,M,C,_,g,A,w;if(c+2>i||(a=new e.Token("table_open","table",1),a.meta={sep:null,cap:null,tr:[]},l.set_highest_alphabet(65536),l.set_initial_state(65792),l.set_accept_states([65552,65553,0]),l.set_match_alphabets({65536:D.bind(this,e,!0),4096:E.bind(this,e,!0),256:T.bind(this,e,!0),16:T.bind(this,e,!0),1:I.bind(this,e,!0)}),l.set_transitions({65792:{65536:256,256:4352},256:{256:4352},4352:{4096:65552,256:4352},65552:{65536:0,16:65553},65553:{65536:0,16:65553,1:65552}}),o.headerless&&(l.set_initial_state(69888),l.update_transition(69888,{65536:4352,4096:65552,256:4352}),r=new e.Token("tr_placeholder","tr",0),r.meta=Object()),o.multibody||l.update_transition(65552,{65536:0,16:65552}),l.set_actions(function(f,W,F){switch(F){case 65536:if(a.meta.cap)break;a.meta.cap=D(e,!1,f),a.meta.cap.map=[f,f+1],a.meta.cap.first=f===c;break;case 4096:a.meta.sep=E(e,!1,f),a.meta.sep.map=[f,f+1],r.meta.grp|=1,p=16;break;case 256:case 16:r=new e.Token("tr_open","tr",1),r.map=[f,f+1],r.meta=T(e,!1,f),r.meta.type=F,r.meta.grp=p,p=0,a.meta.tr.push(r),o.multiline&&(r.meta.multiline&&n<0?n=a.meta.tr.length-1:!r.meta.multiline&&n>=0&&(t=a.meta.tr[n],t.meta.mbounds=a.meta.tr.slice(n).map(function($){return $.meta.bounds}),t.map[1]=r.map[1],a.meta.tr=a.meta.tr.slice(0,n+1),n=-1));break;case 1:r.meta.grp|=1,p=16;break}}),l.execute(c,i)===!1)||!a.meta.tr.length)return!1;if(s)return!0;for(a.meta.tr[a.meta.tr.length-1].meta.grp|=1,a.map=R=[c,0],a.block=!0,a.level=e.level++,e.tokens.push(a),a.meta.cap&&(t=e.push("caption_open","caption",1),t.map=a.meta.cap.map,a.meta.cap.label!==null&&(t.attrs=[["id",a.meta.cap.label]]),t=e.push("inline","",0),t.content=a.meta.cap.text,t.map=a.meta.cap.map,t.children=[],t=e.push("caption_close","caption",-1)),C=0;C<a.meta.tr.length;C++){for(y=new e.Token("td_th_placeholder","",0),r=a.meta.tr[C],r.meta.grp&16&&(h=r.meta.type===256?"thead":"tbody",t=e.push(h+"_open",h,1),t.map=B=[r.map[0],0],v=[]),r.block=!0,r.level=e.level++,e.tokens.push(r),_=0;_<r.meta.bounds.length-1;_++){if(M=[r.meta.bounds[_]+1,r.meta.bounds[_+1]],d=e.src.slice.apply(e.src,M),d===""){S=y.attrGet("colspan"),y.attrSet("colspan",S===null?2:S+1);continue}if(o.rowspan&&v[_]&&d.trim()==="^^"){j=v[_].attrGet("rowspan"),v[_].attrSet("rowspan",j===null?2:j+1),y=new e.Token("td_th_placeholder","",0);continue}if(h=r.meta.type===256?"th":"td",t=e.push(h+"_open",h,1),t.map=r.map,t.attrs=[],a.meta.sep.aligns[_]&&t.attrs.push(["style","text-align:"+a.meta.sep.aligns[_]]),a.meta.sep.wraps[_]&&t.attrs.push(["class","extend"]),y=v[_]=t,o.multiline&&r.meta.multiline&&r.meta.mbounds){for(d=new Array(r.map[0]).fill("").concat([d.trimRight()]),g=1;g<r.meta.mbounds.length;g++)_>r.meta.mbounds[g].length-2||(M=[r.meta.mbounds[g][_]+1,r.meta.mbounds[g][_+1]],d.push(e.src.slice.apply(e.src,M).trimRight()));for(w=new e.md.block.State(d.join(`
`),e.md,e.env,[]),w.level=r.level+1,e.md.block.tokenize(w,r.map[0],w.lineMax),A=0;A<w.tokens.length;A++)e.tokens.push(w.tokens[A])}else t=e.push("inline","",0),t.content=d.trim(),t.map=r.map,t.level=r.level+1,t.children=[];t=e.push(h+"_close",h,-1)}e.push("tr_close","tr",-1),r.meta.grp&1&&(h=r.meta.type===256?"thead":"tbody",t=e.push(h+"_close",h,-1),B[1]=r.map[1])}return R[1]=Math.max(B[1],a.meta.sep.map[1],a.meta.cap?a.meta.cap.map[1]:-1),t=e.push("table_close","table",-1),e.line=R[1],!0}x.block.ruler.at("table",O,{alt:["paragraph","reference"]})};export{q as m};
